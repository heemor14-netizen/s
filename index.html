<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© | ØµÙ†Ø§Ø¹ÙŠØ© ØµØ§Ù…Ø·Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --accent:#2563eb;
  --card:#ffffff;
  --text:#1e293b;
  --muted:#64748b;
  --star:#facc15;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Cairo',sans-serif;
  background:linear-gradient(135deg,#0f172a,#1e293b);
  color:#fff;
}
header{text-align:center;padding:40px 20px}
header p{color:#cbd5f5}
.search-box{max-width:500px;margin:30px auto}
.search-box input{width:100%;padding:14px;border-radius:12px;border:none}
.container{width:90%;max-width:1200px;margin:40px auto}
.section{margin-bottom:60px}
.section h2{border-right:6px solid var(--accent);padding-right:15px}
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:22px}
.card{background:var(--card);color:var(--text);border-radius:16px;padding:22px;box-shadow:0 15px 35px rgba(0,0,0,.2);cursor:pointer;position:relative}
.card p{color:var(--muted);font-size:14px}
.rating{color:var(--star);margin:6px 0}
.location{font-size:13px;color:#475569}
.dashboard{background:#fff;color:var(--text);padding:30px;border-radius:18px;margin-top:30px}
.dashboard input,select,button{width:100%;padding:12px;margin-bottom:15px;border-radius:10px}
.dashboard button{background:var(--accent);color:#fff;border:none;font-size:16px;cursor:pointer}
.delete-btn{position:absolute;top:10px;right:10px;background:red;color:#fff;border:none;padding:5px 10px;border-radius:5px;cursor:pointer}
footer{text-align:center;padding:25px;color:#cbd5f5}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getAuth, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

/* ğŸ”¥ Firebase Config (Ø§Ù„ØµØ­ÙŠØ­) */
const firebaseConfig = {
  apiKey: "AIzaSyBdhesRwD2eiDvqqcMGhC59U4whICwTO3E",
  authDomain: "sanaeya-samtah.firebaseapp.com",
  projectId: "sanaeya-samtah",
  storageBucket: "sanaeya-samtah.appspot.com",
  messagingSenderId: "1092994215610",
  appId: "1:1092994215610:web:e68b5a3eccb24235d39c83"
};

/* Initialize */
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

/* ğŸ‘‘ Ø§Ù„Ø£Ø¯Ù…Ù† */
const ADMINS = ["heemoxo41430@gmail.com", "heemor14@gmail.com"];
</script>


/* ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
window.login = async () => {
  const res = await signInWithPopup(auth, provider);
  const user = { name: res.user.displayName, email: res.user.email };
  localStorage.setItem('user', JSON.stringify(user));
  document.getElementById('userStatus').innerText =
    `âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ€ ${user.name}`;
  reloadWorkshops();
};

/* â• Ø¥Ø¶Ø§ÙØ© ÙˆØ±Ø´Ø© */
window.addWorkshop = async () => {
  if(!isAdmin()) return alert('Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·');
  await addDoc(collection(db,"workshops"),{
    name:name.value,
    spec:spec.value,
    cat:category.value,
    phone:phone.value,
    loc:loc.value,
    rate:Number(rate.value)
  });
  reloadWorkshops();
};

/* ğŸ—‘ï¸ Ø­Ø°Ù */
window.deleteWorkshop = async id => {
  if(!isAdmin()) return;
  await deleteDoc(doc(db,"workshops",id));
  reloadWorkshops();
};

/* ğŸ§± Ø¹Ø±Ø¶ */
function renderWorkshop(w){
  const stars = 'â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†'.slice(5-w.rate,10-w.rate);
  const c = document.createElement('div');
  c.className='card';
  c.dataset.search=(w.name+' '+w.spec).toLowerCase();
  c.innerHTML=`
    <h3>${w.name}</h3>
    <p>${w.spec}</p>
    <div class="rating">${stars}</div>
    <div class="location">ğŸ“ ${w.phone}</div>
    <div class="location">ğŸ“ ${w.loc}</div>`;
  if(isAdmin()){
    const b=document.createElement('button');
    b.className='delete-btn'; b.innerText='Ø­Ø°Ù';
    b.onclick=e=>{e.stopPropagation();deleteWorkshop(w.id)};
    c.appendChild(b);
  }
  document.getElementById(w.cat+'Cards').appendChild(c);
}

/* ğŸ”„ ØªØ­Ù…ÙŠÙ„ */
async function reloadWorkshops(){
  carsCards.innerHTML='';
  generalCards.innerHTML='';
  const qs=await getDocs(collection(db,"workshops"));
  qs.forEach(d=>renderWorkshop({...d.data(),id:d.id}));
}

/* ğŸ” Ø¨Ø­Ø« */
search.onkeyup=e=>{
  document.querySelectorAll('.card').forEach(c=>{
    c.style.display=c.dataset.search.includes(e.target.value.toLowerCase())?'':'none';
  });
};

window.onload=reloadWorkshops;
</script>
</head>

<body>

<header>
  <h1>Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© â€“ ØµÙ†Ø§Ø¹ÙŠØ© ØµØ§Ù…Ø·Ø©</h1>
  <p>Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ ÙŠØ¬Ù…Ø¹ ÙˆØ±Ø´ ÙˆØµÙ†Ø§ÙŠØ¹ÙŠØ© ØµÙ†Ø§Ø¹ÙŠØ© ØµØ§Ù…Ø·Ø©</p>
  <div class="search-box">
    <input id="search" placeholder="ğŸ” Ø§Ø¨Ø­Ø«">
  </div>
</header>

<div class="container">

<section class="section">
<h2>ØµÙ†Ø§Ø¹ÙŠØ§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</h2>
<div class="cards" id="carsCards"></div>
</section>

<section class="section">
<h2>Ø§Ù„ÙˆØ±Ø´ Ø§Ù„Ø¹Ø§Ù…Ø©</h2>
<div class="cards" id="generalCards"></div>
</section>

<section class="section">
<h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
<div class="dashboard">
  <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¬ÙˆØ¬Ù„</button>
  <p id="userStatus"></p>
  <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙˆØ±Ø´Ø©">
  <input id="spec" placeholder="Ø§Ù„ØªØ®ØµØµ">
  <select id="category">
    <option value="cars">Ø³ÙŠØ§Ø±Ø§Øª</option>
    <option value="general">Ø¹Ø§Ù…Ø©</option>
  </select>
  <input id="phone" placeholder="Ø§Ù„Ø¬ÙˆØ§Ù„">
  <input id="loc" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹">
  <select id="rate">
    <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
    <option value="4">â˜…â˜…â˜…â˜…â˜†</option>
    <option value="3">â˜…â˜…â˜…â˜†â˜†</option>
  </select>
  <button onclick="addWorkshop()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ±Ø´Ø©</button>
</div>
</section>

</div>

<footer>Â© 2025 Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© â€“ ØµÙ†Ø§Ø¹ÙŠØ© ØµØ§Ù…Ø·Ø©</footer>
</body>
</html>

