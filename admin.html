<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø·ÙˆØ±</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Cairo',sans-serif;
  background:#0f172a;
  color:#fff;
}
.container{
  max-width:900px;
  margin:40px auto;
  background:#fff;
  color:#1e293b;
  padding:30px;
  border-radius:16px;
}
h1{text-align:center;margin-bottom:30px}

form input,form select,form button{
  width:100%;
  padding:12px;
  margin-bottom:12px;
  border-radius:10px;
  border:1px solid #cbd5f5;
  font-family:'Cairo';
}

form button{
  background:#2563eb;
  color:#fff;
  border:none;
  font-size:16px;
  cursor:pointer;
}

#msg{
  margin-top:10px;
  color:green;
  font-weight:600;
  display:none;
}

.list{
  margin-top:40px;
}

.item{
  background:#f1f5f9;
  padding:15px;
  border-radius:12px;
  margin-bottom:12px;
}

.item button{
  margin-left:8px;
  padding:6px 12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-family:'Cairo';
}

.edit{background:#facc15}
.del{background:#ef4444;color:#fff}
</style>
</head>

<body>

<div class="container">
<h1>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ±Ø´</h1>

<form id="form">
  <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙˆØ±Ø´Ø©" required>
  <input id="spec" placeholder="Ø§Ù„ØªØ®ØµØµ" required>

  <select id="cat">
    <option value="cars">Ø³ÙŠØ§Ø±Ø§Øª</option>
    <option value="metal">Ø­Ø¯Ø§Ø¯Ø©</option>
    <option value="sofa">ÙƒÙ†Ø¨</option>
    <option value="aluminum">Ø£Ù„Ù…Ù†ÙŠÙˆÙ…</option>
  </select>

  <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„" inputmode="numeric" pattern="[0-9]*" required>
  <input id="loc" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹" required>

  <select id="rate">
    <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
    <option value="4">â˜…â˜…â˜…â˜…â˜†</option>
    <option value="3">â˜…â˜…â˜…â˜†â˜†</option>
  </select>

  <button type="submit">Ø­ÙØ¸ Ø§Ù„ÙˆØ±Ø´Ø©</button>
  <div id="msg">âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ±Ø´Ø© Ø¨Ù†Ø¬Ø§Ø­</div>
</form>

<div class="list" id="list"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import {
  getFirestore, collection, addDoc, getDocs,
  deleteDoc, updateDoc, doc
} from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

/* ğŸ”¥ Firebase (sanaeya-samtah) */
const firebaseConfig = {
  apiKey: "AIzaSyBdhesRwD2eiDvqqcMGhC59U4whICwTO3E",
  authDomain: "sanaeya-samtah.firebaseapp.com",
  projectId: "sanaeya-samtah",
  storageBucket: "sanaeya-samtah.firebasestorage.app",
  messagingSenderId: "1092994215610",
  appId: "1:1092994215610:web:e68b5a3eccb24235d39c83"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ğŸ”— Ø¹Ù†Ø§ØµØ± */
const form = document.getElementById("form");
const list = document.getElementById("list");
const msg = document.getElementById("msg");

const nameInput = document.getElementById("name");
const specInput = document.getElementById("spec");
const catInput = document.getElementById("cat");
const phoneInput = document.getElementById("phone");
const locInput = document.getElementById("loc");
const rateInput = document.getElementById("rate");

let editId = null;

/* â• Ø¥Ø¶Ø§ÙØ© / âœï¸ ØªØ¹Ø¯ÙŠÙ„ */
form.onsubmit = async e => {
  e.preventDefault();

  const data = {
    name: nameInput.value.trim(),
    spec: specInput.value.trim(),
    cat: catInput.value,
    phone: phoneInput.value.trim(),
    loc: locInput.value.trim(),
    rate: Number(rateInput.value)
  };

  if(editId){
    await updateDoc(doc(db,"workshops",editId), data);
    editId = null;
  }else{
    await addDoc(collection(db,"workshops"), data);
    msg.style.display="block";
    setTimeout(()=>msg.style.display="none",2500);
  }

  form.reset();
  load();
};

/* ğŸ§¾ Ø¹Ø±Ø¶ */
async function load(){
  list.innerHTML="";
  const q = await getDocs(collection(db,"workshops"));
  q.forEach(d=>{
    const w = d.data();
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML=`
      <b>${w.name}</b> â€“ ${w.spec}<br>
      ğŸ“ ${w.phone} | ğŸ“ ${w.loc}<br><br>
      <button class="edit">ØªØ¹Ø¯ÙŠÙ„</button>
      <button class="del">Ø­Ø°Ù</button>
    `;
    div.querySelector(".edit").onclick=()=>{
      editId=d.id;
      nameInput.value=w.name;
      specInput.value=w.spec;
      catInput.value=w.cat;
      phoneInput.value=w.phone;
      locInput.value=w.loc;
      rateInput.value=w.rate;
    };
    div.querySelector(".del").onclick=async()=>{
      if(confirm("Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ")){
        await deleteDoc(doc(db,"workshops",d.id));
        load();
      }
    };
    list.appendChild(div);
  });
}

load();
</script>

</body>
</html>

